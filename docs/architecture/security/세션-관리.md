# ğŸ• ì„¸ì…˜ ê´€ë¦¬

## Stateless Session (JWT)

**ì„¸ì…˜ ì €ì¥ì†Œ ì—†ìŒ:**
- JWTì— ëª¨ë“  ì‚¬ìš©ì ì •ë³´ í¬í•¨
- ì„œë²„ëŠ” ìƒíƒœë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŒ (Stateless)
- í™•ì¥ì„± ìš°ìˆ˜

## Token Expiration

**Access Token:**
- ìœ íš¨ê¸°ê°„: 1ì‹œê°„
- ì§§ì€ ìˆ˜ëª…ìœ¼ë¡œ ë³´ì•ˆ ê°•í™”

**Refresh Token:**
- ìœ íš¨ê¸°ê°„: 7ì¼
- Access Token ê°±ì‹ ìš©
- Redisì— ì €ì¥í•˜ì—¬ ë¬´íš¨í™” ê°€ëŠ¥

```java
@Service
@RequiredArgsConstructor
public class TokenService {
    
    private final RedisTemplate<String, String> redisTemplate;
    
    private static final long ACCESS_TOKEN_VALIDITY = 60 * 60; // 1 hour
    private static final long REFRESH_TOKEN_VALIDITY = 7 * 24 * 60 * 60; // 7 days
    
    public String createAccessToken(User user) {
        return Jwts.builder()
            .setSubject(user.getId())
            .claim("username", user.getUsername())
            .claim("roles", user.getRoles())
            .claim("permissions", user.getPermissions())
            .setIssuedAt(new Date())
            .setExpiration(new Date(System.currentTimeMillis() + ACCESS_TOKEN_VALIDITY * 1000))
            .signWith(SignatureAlgorithm.HS256, SECRET_KEY)
            .compact();
    }
    
    public String createRefreshToken(String userId) {
        String refreshToken = UlidGenerator.generate();
        
        // Store in Redis with expiration
        redisTemplate.opsForValue().set(
            "refresh_token:" + refreshToken,
            userId,
            REFRESH_TOKEN_VALIDITY,
            TimeUnit.SECONDS
        );
        
        return refreshToken;
    }
    
    public void invalidateRefreshToken(String refreshToken) {
        redisTemplate.delete("refresh_token:" + refreshToken);
    }
}
```

## Session Timeout Warning

**Frontendì—ì„œ êµ¬í˜„:**

```typescript
// 5ë¶„ ì „ ê²½ê³ 
if (tokenExpiresIn < 5 * 60) {
  showSessionWarning("Your session will expire in 5 minutes");
}

// 1ë¶„ ì „ ê²½ê³ 
if (tokenExpiresIn < 1 * 60) {
  showSessionWarning("Your session will expire in 1 minute. Please save your work.");
}

// ë§Œë£Œ ì‹œ ìë™ ë¡œê·¸ì•„ì›ƒ
if (tokenExpiresIn <= 0) {
  logout();
}
```

## Multi-Tab Synchronization

**BroadcastChannel API ì‚¬ìš©:**

```typescript
const channel = new BroadcastChannel('auth_channel');

// ë¡œê·¸ì•„ì›ƒ ì‹œ ëª¨ë“  íƒ­ì— ì•Œë¦¼
channel.postMessage({ type: 'LOGOUT' });

// ë‹¤ë¥¸ íƒ­ì—ì„œ ë¡œê·¸ì•„ì›ƒ ê°ì§€
channel.onmessage = (event) => {
  if (event.data.type === 'LOGOUT') {
    logout(); // í˜„ì¬ íƒ­ë„ ë¡œê·¸ì•„ì›ƒ
  }
};
```

---
