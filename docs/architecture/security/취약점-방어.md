# ğŸš« ì·¨ì•½ì  ë°©ì–´

## SQL Injection ë°©ì–´

**MyBatis Parameterized Queries ì‚¬ìš©:**

```xml
<!-- âœ… Good - Parameterized -->
<select id="findByEmail" resultType="User">
    SELECT * FROM "user"
    WHERE email = #{email}
      AND deleted = FALSE
</select>

<!-- âŒ Bad - String concatenation (VULNERABLE!) -->
<select id="findByEmail" resultType="User">
    SELECT * FROM "user"
    WHERE email = '${email}'
</select>
```

## XSS (Cross-Site Scripting) ë°©ì–´

**ì…ë ¥ ê²€ì¦ ë° ì¶œë ¥ ì¸ì½”ë”©:**

```java
@Service
public class XssProtectionService {
    
    private final PolicyFactory policy = Sanitizers.FORMATTING.and(Sanitizers.LINKS);
    
    public String sanitize(String input) {
        if (input == null) {
            return null;
        }
        return policy.sanitize(input);
    }
}
```

**Frontendì—ì„œë„ ë°©ì–´:**
```typescript
// Vue 3ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ XSS ë°©ì–´
<template>
  <div>{{ userInput }}</div>  <!-- ìë™ ì´ìŠ¤ì¼€ì´í”„ -->
  <div v-html="sanitizedHtml"></div>  <!-- ê²€ì¦ëœ HTMLë§Œ -->
</template>
```

## CSRF ë°©ì–´

**JWT ì‚¬ìš© ì‹œ ìë™ ë°©ì–´:**
- Stateless ë°©ì‹
- Cookie ë¯¸ì‚¬ìš©
- CSRF í† í° ë¶ˆí•„ìš”

## Path Traversal ë°©ì–´

```java
@Service
public class FileService {
    
    @Value("${file.upload.dir}")
    private String uploadDir;
    
    public File getFile(String filename) {
        // Validate filename
        if (filename.contains("..") || filename.contains("/") || filename.contains("\\")) {
            throw new SecurityException("Invalid filename");
        }
        
        // Resolve canonical path
        File file = new File(uploadDir, filename);
        try {
            String canonicalPath = file.getCanonicalPath();
            if (!canonicalPath.startsWith(uploadDir)) {
                throw new SecurityException("Path traversal attempt detected");
            }
        } catch (IOException e) {
            throw new SecurityException("Invalid file path");
        }
        
        return file;
    }
}
```

## Command Injection ë°©ì–´

**ProcessBuilder ì‚¬ìš© (Runtime.exec() ì§€ì–‘):**

```java
// âœ… Good
ProcessBuilder pb = new ProcessBuilder("command", "arg1", "arg2");
Process process = pb.start();

// âŒ Bad - Command injection vulnerable
Runtime.getRuntime().exec("command " + userInput);
```

---
