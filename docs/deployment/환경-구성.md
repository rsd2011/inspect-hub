# 환경 구성

## 환경 변수 관리

**Backend (.env.production)**
```bash
# Application
SPRING_PROFILES_ACTIVE=production
SERVER_PORT=8090
APP_NAME=inspect-hub
APP_VERSION=1.0.0

# Database
DB_HOST=postgres-primary.prod.svc.cluster.local
DB_PORT=5432
DB_NAME=inspecthub_prod
DB_USERNAME=inspecthub_app
DB_PASSWORD=${DB_PASSWORD}  # Secret Manager에서 주입
DB_POOL_SIZE=20
DB_POOL_MAX_SIZE=50

# Redis
REDIS_HOST=redis-cluster.prod.svc.cluster.local
REDIS_PORT=6379
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_POOL_SIZE=10

# Kafka
KAFKA_BOOTSTRAP_SERVERS=kafka-0.kafka.prod.svc.cluster.local:9092,kafka-1.kafka.prod.svc.cluster.local:9092,kafka-2.kafka.prod.svc.cluster.local:9092
KAFKA_CONSUMER_GROUP=inspecthub-group

# Security
JWT_SECRET=${JWT_SECRET}  # 256-bit secret
JWT_ACCESS_TOKEN_EXPIRY=3600000   # 1 hour
JWT_REFRESH_TOKEN_EXPIRY=604800000  # 7 days

# Encryption
ENCRYPTION_KEY=${ENCRYPTION_KEY}  # AES-256 key
ENCRYPTION_ALGORITHM=AES/GCM/NoPadding

# External Services
FIU_API_URL=https://fiu.fss.or.kr/api/v1
FIU_API_KEY=${FIU_API_KEY}

# Monitoring
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,metrics,prometheus
MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED=true

# Logging
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_COM_INSPECTHUB=DEBUG
LOGGING_FILE_PATH=/var/log/inspecthub
LOGGING_FILE_MAX_SIZE=100MB
LOGGING_FILE_MAX_HISTORY=30
```

**Frontend (.env.production)**
```bash
# API
NUXT_PUBLIC_API_BASE=https://api.inspecthub.com/api/v1

# Application
NUXT_PUBLIC_APP_NAME=Inspect-Hub
NUXT_PUBLIC_APP_VERSION=1.0.0

# SSR (반드시 false)
NUXT_SSR=false

# Build
NODE_ENV=production
```

## Secrets 관리

**Kubernetes Secrets**
```yaml
# secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: inspecthub-secrets
  namespace: production
type: Opaque
stringData:
  db-password: "{{ DB_PASSWORD }}"
  redis-password: "{{ REDIS_PASSWORD }}"
  jwt-secret: "{{ JWT_SECRET }}"
  encryption-key: "{{ ENCRYPTION_KEY }}"
  fiu-api-key: "{{ FIU_API_KEY }}"
```

**생성 및 적용:**
```bash
# Base64 인코딩된 값으로 시크릿 생성
kubectl create secret generic inspecthub-secrets \
  --from-literal=db-password='your-db-password' \
  --from-literal=redis-password='your-redis-password' \
  --from-literal=jwt-secret='your-jwt-secret' \
  --from-literal=encryption-key='your-encryption-key' \
  --from-literal=fiu-api-key='your-fiu-api-key' \
  --namespace=production

# 또는 파일에서 로드
kubectl apply -f secrets.yaml
```

---
