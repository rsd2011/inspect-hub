# ğŸ›¡ ë„ë©”ì¸ ê·œì¹™ ìœ„ë°˜ ì²˜ë¦¬

## DomainException ì •ì˜

**ìœ„ì¹˜**: `backend/common/src/main/java/com/inspecthub/common/exception/DomainException.java`

```java
/**
 * ë„ë©”ì¸ ë¶ˆë³€ì‹ ìœ„ë°˜ ì˜ˆì™¸
 * 
 * Entity/VO ìƒì„± ë˜ëŠ” ìƒíƒœ ì „ì´ ì‹œ ê·œì¹™ ìœ„ë°˜ì„ ì¦‰ì‹œ ê°ì§€
 */
public class DomainException extends RuntimeException {
    
    public DomainException(String message) {
        super(message);
    }
    
    public DomainException(String message, Throwable cause) {
        super(message, cause);
    }
}
```

## Entityì—ì„œ ê·œì¹™ ê²€ì¦

```java
@Entity
@Table(name = "DETECTION_CASE")
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public class DetectionCase {
    
    @Id
    private String caseId;
    
    @Enumerated(EnumType.STRING)
    private CaseStatus status;
    
    /**
     * Factory Method - ìœ íš¨ì„± ê²€ì¦ í¬í•¨
     */
    public static DetectionCase create(String caseId, CaseType type) {
        if (caseId == null || caseId.isBlank()) {
            throw new DomainException("ì¼€ì´ìŠ¤ IDëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤");
        }
        
        DetectionCase detectionCase = new DetectionCase();
        detectionCase.caseId = caseId;
        detectionCase.status = CaseStatus.OPEN;
        detectionCase.createdAt = LocalDateTime.now();
        
        return detectionCase;
    }
    
    /**
     * ìƒíƒœ ì „ì´ ê²€ì¦
     */
    public void close(String closureReason) {
        if (this.status == CaseStatus.CLOSED) {
            throw new DomainException("ì´ë¯¸ ì¢…ë£Œëœ ì¼€ì´ìŠ¤ì…ë‹ˆë‹¤");
        }
        
        if (closureReason == null || closureReason.isBlank()) {
            throw new DomainException("ì¢…ë£Œ ì‚¬ìœ ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤");
        }
        
        this.status = CaseStatus.CLOSED;
        this.closedAt = LocalDateTime.now();
    }
}
```

## Value Object ë¶ˆë³€ì„± ë³´ì¥

```java
@Embeddable
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@AllArgsConstructor(access = AccessLevel.PRIVATE)
public class Money {
    
    private BigDecimal amount;
    
    @Enumerated(EnumType.STRING)
    private Currency currency;
    
    public static Money of(BigDecimal amount, Currency currency) {
        if (amount == null || amount.compareTo(BigDecimal.ZERO) < 0) {
            throw new DomainException("ê¸ˆì•¡ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        }
        
        if (currency == null) {
            throw new DomainException("í†µí™”ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤");
        }
        
        return new Money(amount, currency);
    }
    
    public Money add(Money other) {
        if (!this.currency.equals(other.currency)) {
            throw new DomainException("í†µí™”ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤");
        }
        
        return new Money(this.amount.add(other.amount), this.currency);
    }
}
```

---
