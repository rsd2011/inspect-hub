# 베스트 프랙티스

## 1. Store 분리 원칙

**✅ DO:**
- 도메인별로 Store 분리
- 단일 책임 원칙 (SRP) 적용
- 5-10개의 action으로 제한

**❌ DON'T:**
- 모든 것을 하나의 큰 Store에 담기
- Store 간 강한 결합
- 너무 많은 state 관리

## 2. Action 설계

```typescript
// ✅ Good: 명확한 action 이름
async function fetchUserById(id: string) { /* ... */ }
async function updateUserProfile(id: string, data: Partial<User>) { /* ... */ }
async function deleteUser(id: string) { /* ... */ }

// ❌ Bad: 모호한 이름
async function get(id: string) { /* ... */ }
async function save(data: any) { /* ... */ }
async function remove(id: string) { /* ... */ }
```

## 3. 에러 처리

```typescript
export const useUserStore = defineStore('user', () => {
  const error = ref<Error | null>(null)
  const isLoading = ref(false)

  async function fetchUsers() {
    isLoading.value = true
    error.value = null  // 이전 에러 초기화
    
    try {
      const response = await userApi.getUsers()
      // ...
    } catch (err) {
      error.value = err as Error
      
      // UI Store를 통한 사용자 알림
      const uiStore = useUIStore()
      uiStore.showToast('사용자 목록을 불러오는데 실패했습니다', 'error')
      
      throw err  // 상위로 전파
    } finally {
      isLoading.value = false
    }
  }

  return {
    error,
    isLoading,
    fetchUsers
  }
})
```

## 4. TypeScript 타입 안정성

```typescript
// ✅ Good: 타입 정의
interface UserState {
  users: User[]
  currentUser: User | null
  isLoading: boolean
}

const state = ref<UserState>({
  users: [],
  currentUser: null,
  isLoading: false
})

// ❌ Bad: any 사용
const state = ref<any>({
  users: [],
  currentUser: null
})
```

## 5. 초기화 및 정리

```typescript
// app.vue
<script setup lang="ts">
import { useAuthStore } from '~/features/auth/model/auth.store'
import { useNotificationStore } from '~/features/notification/model/notification.store'

const authStore = useAuthStore()
const notificationStore = useNotificationStore()

// 앱 초기화
onMounted(() => {
  if (authStore.isAuthenticated) {
    notificationStore.connectSSE()
  }
})

// 정리
onBeforeUnmount(() => {
  notificationStore.disconnectSSE()
})
</script>
```

## 6. Devtools 활용

```typescript
// 개발 환경에서 Devtools 활성화
export const useUserStore = defineStore('user', () => {
  // ... store implementation
  
  // Devtools에서 확인하기 쉬운 이름 설정
  if (import.meta.dev) {
    console.log('[Store] User store initialized')
  }
  
  return { /* ... */ }
})
```

---
